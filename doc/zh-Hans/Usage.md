# 使用指南

目录：

- [安装](#安装)

- [功能介绍](#功能介绍)

- [配置选项](#配置选项)

- [问题反馈](#问题反馈)

- [已知问题](#已知问题)

# 安装

> **注意**：该插件仅适用于 Windows 版的 Blender。

> 支持 Blender 3.0.0 - 3.6.0，更新的版本或许也支持。

1. 在 [发布](https://github.com/Arius-Cr/wire_ext_blender_fix_ime/releases) 页面下载最新版的插件（.zip）。

2. 按 [Blender 用户手册](https://docs.blender.org/manual/zh-hans/3.5/editors/preferences/addons.html#installing-add-ons) 提供的方式安装插件。

# 功能介绍

## 自动管理输入法状态

> 启用选项：配置 > 自动管理输入法状态

功能启用后：

1. 以任意方式激活输入框时，插件会自动启用输入法，你可以正常使用输入法输入文字。

2. 以任意方式退出输入框时，插件会自动停用输入法，输入法将不再接管你的任何按键。

## 使用输入法输入文字

> 启用选项：配置 > 使用输入法输入文字

功能启用后，可以在文本物体的编辑模式、文本编辑器、控制台中直接使用输入法输入文字。

你必须将鼠标移动到编辑器的视图区中，才能使用输入法输入文字。

鼠标一旦移出视图区会自动停用输入法。

其它特性：

- 当正在输入文本时（即候选窗口显示时）：

    1. 鼠标移出视图区不会自动停用输入法。

    2. 鼠标任意按键按下会自动取消当前正在输入的文本。

- 在文本物体的编辑模式中，通过 Shift + 鼠标按键 进行视图变换时，在释放 Shift 键后，会自动恢复按下 Shift 键时的输入模式（中/英），即此时的 Shift 键不会导致输入模式改变。

- 在文本物体的编辑模式中，输入法的候选窗口显示在屏幕底部相对左侧的某个位置，可以通过 **候选窗口水平位置** 选项设置相对左侧的位置。

- 在文本编辑器中，输入法的候选窗口显示在光标附近。该位置目前做不到精确。

- 在控制台中，输入法的候选窗口显示在编辑器底部下方，如果下方空间不够，会显示在编辑器底部稍上的位置。目前无法跟踪光标的位置。

其它相关选项请参考：[配置选项](#配置选项)。

# 配置选项

- **自动管理输入法状态**

    启用 [自动管理输入法状态](#自动管理输入法状态) 功能。

    - **使用输入法输入文字**

        启用 [使用输入法输入文字](#使用输入法输入文字) 功能。

        > 仅在启用了 **自动管理输入法状态** 时，该选项才有效。

        - **文本物体编辑模式**

            在 3D 视图的文本物体的编辑模式中，允许使用输入法输入文字。

        - **候选窗口水平位置**

            在 3D 视图的文本物体的编辑模式中，使用输入法输入文字时，输入法的候选窗口将定位在屏幕工作区的底部，你可以设置候选窗口的左侧相对屏幕左侧的位置，取值范围0-1，表示百分比。

            候选窗口的实际位置会由系统自动进行二次调整。

        - **文本编辑器**

            在文本编辑器中，允许使用输入法输入文字。

            文本编辑器至少关联一个文本对象时才有效。

        - **控制台**

            在控制台中，允许使用输入法输入文字。

- **显示状态提示**

    - **文本编辑器**

        在文本编辑器标题栏的右侧显示 **使用输入法输入文字** 功能相关的状态提示。

    - **控制台**

        在控制台标题栏的右侧显示 **使用输入法输入文字** 功能相关的状态提示。

    图标的含义如下：

    1. 当图标变灰，表示当前没有启用 **使用输入法输入文字** 功能，或启用无效（譬如没有启用 **自动管理输入法状态** 选项）。

    2. <p><image src="../images/state_icon_1.jpg" width=20 />：用户没有启用针对当前情况的功能。譬如在文本编辑器中看到该图标，则表示没有启用 <b>使用输入法输入文字</b> > <b>文本编辑器</b> 选项。</p>

    3. <p><image src="../images/state_icon_2.jpg" width=20 />：用户已经启用针对当前情况的功能。</p>

    4. <p><image src="../images/state_icon_3.jpg" width=20 />：鼠标进入视图区，并且插件已经为你启用输入法，你可以直接通过输入法输入文字。</p>

- **调试**

    启用调试模式。

    启用后，将在控制台中持续输出运行状态，便于开发者检查问题。

# 问题反馈

如在使用中遇到问题，可以向开发者反馈问题，为了让反馈更高效，可以考虑按照以下步骤收集信息后再反馈：

1. 双击 Blender 安装目录中的 **blender_debug_log.cmd**，按任意键后，会自动运行 Blender。

2. **启用本插件的 调试 选项**。

3. **操作并触发一次问题**。

4. 如果是会导致 Blender 崩溃的问题，则崩溃后会自动打开一个目录，里面包含了两个文件：**blender_debug_output.txt**、**blender_system_info.txt**。

5. 如果是不会导致 Blender 崩溃的问题，则手动退出 Blender 后同样会自动打开上述的目录，同样存在上述的两个文件。

6. **反馈时请尽量附上上述的两个文件**，没有也可以，不是硬性要求。如果有截图也可以附上截图。

7. 反馈时请简要清晰地描述：**如何操作能够复现问题**。<br />
**如果是无法百分百复现的问题，请尽量多地描述该问题相关的一些特征**。

你可以通过 GitHub 中的 Issues 功能、邮件或相关评论区中进行反馈。

# 已知问题

1. 搜狗拼音输入法在中文输入模式时，在 Blender 的输入框中无法通过数字键盘输入“.”，这个不是本插件引起的问题。

2. 修改 **候选窗口水平位置** 后，搜狗拼音输入法的候选窗口的位置不一定能够马上产生变化。目前这个问题没有解决思路。

3. 在微软拼音输入法的候选窗口打开的情况下，滚动鼠标滚轮会导致候选窗口消失，但不会中止输入，按常规的方式继续输入文字，候选窗口会重新出现。这似乎是微软拼音自身的特性。

4. 在文本编辑器中用英文模式输入“1”，然后将任意物体切换为编辑模式，然后继续输入“2”，按一次撤销，“2”被撤销，再按一次撤销，**物体不会变回物体模式**，再按一次撤销，“1”被撤销，此时物体才变回物体模式。但按三次重做，会发现重做是遵循操作发生的次序进行的。因为使用英文输入法，所以插件并未进行任何干预，并且该问题同样出现在其它和插件无关的场合，因此这似乎是 Blender 自身的问题。